#!/bin/bash
[[ -z "$1" ]] && echo "Opens the filepath on a JSON value, and converts it to a URI scheme. Accept a JSON string on STDIN"; echo "Usage: urify {KEY}"; exit 1
read -r TEXT

IMAGE=$(echo "$TEXT" | jq -r ".$1")
MIME=$(file -bN --mime-type "$IMAGE")
echo "data:$mimetype;base64,$(base64 -w 0 "$IMAGE")" > "$IMAGE.b64"
TEXT=$(echo "$TEXT" | jq --rawfile img "$IMAGE.b64" ".$1 = \$img")
rm "$IMAGE.b64"
echo "$TEXT"
